# 🎮 GitHub Pages 上的数据库功能使用指南

## 🚀 部署完成状态

✅ **前端更新已部署到 GitHub Pages**
- 网站地址: https://fyx0730.github.io/game-time-monitor/
- 包含所有最新的数据库相关功能
- 支持智能存储选择（数据库优先，本地存储备用）

## 📋 当前功能状态

### ✅ 前端功能 (GitHub Pages)
1. **基础游戏监控** - 完全可用
   - MQTT 连接和实时监控
   - 游戏时长统计
   - 事件日志记录
   - 图表展示

2. **本地存储** - 完全可用
   - localStorage 数据持久化
   - 数据导入/导出功能
   - 调试工具和故障排除

3. **云端存储接口** - 已集成但需要后台服务
   - 自动检测后台服务可用性
   - 智能回退到本地存储
   - 手动配置后台地址功能

### 🔄 后台功能 (需要额外部署)
1. **SQLite 数据库** - 需要 Railway 部署
2. **跨设备同步** - 需要后台服务
3. **统计查询 API** - 需要后台服务

---

## 🌐 使用 GitHub Pages 版本

### 1. 立即可用的功能

访问 https://fyx0730.github.io/game-time-monitor/ 即可使用：

```
📱 基础功能:
✅ MQTT 设备监控
✅ 实时游戏时长统计
✅ 在线设备数量图表
✅ 事件日志记录
✅ 本地数据持久化
✅ 数据导入/导出
✅ 响应式设计
```

### 2. 配置 MQTT 连接

使用安全的 WebSocket 连接（必需）：
```
推荐的 MQTT Broker:
- wss://broker.hivemq.com:8884/mqtt
- wss://test.mosquitto.org:8081/mqtt
- wss://broker.emqx.io:8084/mqtt
```

⚠️ **重要**: GitHub Pages 使用 HTTPS，必须使用 `wss://` 而非 `ws://`

### 3. 数据存储说明

当前在 GitHub Pages 上的数据存储方式：

```
📁 本地存储 (localStorage)
├── 游戏时长数据
├── 玩家会话记录
├── 事件日志
├── MQTT 连接设置
└── 云端配置信息
```

---

## 🚀 启用完整数据库功能

如果您需要跨设备数据同步和高级统计功能，需要部署后台服务：

### 选项 1: 使用现有的 Railway 服务

您已经有一个 Railway 部署的后台服务：
```
生产环境地址: https://game-time-monitor-production.up.railway.app
健康检查: https://game-time-monitor-production.up.railway.app/api/health
```

**激活步骤：**
1. 确认 Railway 服务正常运行
2. 在前端配置中设置后台地址
3. 启用云端存储功能

### 选项 2: 重新部署到 Railway

使用最新的代码重新部署：

```bash
# 1. 推送最新代码到 GitHub
git push origin main

# 2. 在 Railway 中重新部署
# - 访问 railway.app
# - 选择项目
# - 点击 "Deploy" 重新部署
```

---

## 🔧 前端配置

### 1. 启用云端存储

在网页中点击设置，配置后台服务地址：

```javascript
// 自动配置 (推荐)
后台服务地址: https://game-time-monitor-production.up.railway.app

// 或手动配置
后台服务地址: 您的 Railway 应用地址
```

### 2. 测试连接

前端会自动测试后台连接：
- ✅ 连接成功：显示 "云端: ✅ 已连接"
- ❌ 连接失败：自动回退到本地存储

### 3. 数据迁移

如果您有现有的本地数据，前端会自动尝试同步到云端数据库。

---

## 📊 功能对比

| 功能 | GitHub Pages (仅前端) | 完整版 (前端+后台) |
|------|----------------------|-------------------|
| MQTT 监控 | ✅ 完全支持 | ✅ 完全支持 |
| 本地数据存储 | ✅ localStorage | ✅ localStorage + 数据库 |
| 跨设备同步 | ❌ 不支持 | ✅ 完全支持 |
| 高级统计 | ⚠️ 基础统计 | ✅ 完整统计 API |
| 数据备份 | ⚠️ 手动导出 | ✅ 自动备份 |
| 并发安全 | ⚠️ 单设备 | ✅ 多设备安全 |
| 性能 | ⭐⭐⭐ 良好 | ⭐⭐⭐⭐⭐ 优秀 |

---

## 🛠️ 故障排除

### 1. MQTT 连接失败

**问题**: 显示"混合内容"错误
```
解决方案:
✅ 使用 wss:// 而非 ws://
✅ 检查 Broker 是否支持 WSS
✅ 尝试其他公共 MQTT Broker
```

### 2. 数据丢失

**问题**: 刷新页面后数据消失
```
检查项目:
1. 浏览器是否启用隐私模式
2. 是否禁用了 localStorage
3. 是否清除了浏览器数据

解决方案:
✅ 允许 GitHub Pages 存储数据
✅ 定期导出数据备份
✅ 启用云端存储同步
```

### 3. 云端存储无法连接

**问题**: 显示"云端: ❌ 离线"
```
检查项目:
1. Railway 服务是否正常运行
2. 后台地址是否正确配置
3. 网络连接是否正常

解决方案:
✅ 访问健康检查地址确认服务状态
✅ 重新配置后台服务地址
✅ 检查 CORS 配置
```

---

## 📱 使用建议

### 1. 推荐配置

```
🎯 最佳实践:
1. 使用 WSS MQTT Broker
2. 定期导出数据备份
3. 配置云端存储（如果需要跨设备）
4. 定期清理历史事件日志
```

### 2. 性能优化

```
⚡ 优化建议:
1. 限制事件日志数量 (当前: 50条)
2. 使用稳定的 MQTT Broker
3. 避免频繁刷新页面
4. 定期清理浏览器缓存
```

---

## 🔮 后续计划

### 即将推出的功能

1. **离线模式增强** - 支持完全离线使用
2. **PWA 支持** - 安装为桌面应用
3. **数据分析面板** - 更丰富的统计图表
4. **自动备份** - 定时数据导出
5. **多语言支持** - 国际化界面

### 升级路径

1. **当前阶段**: GitHub Pages + 本地存储
2. **下一阶段**: GitHub Pages + Railway 后台
3. **未来阶段**: 完整的云原生解决方案

---

## 📞 获取帮助

如果遇到问题：

1. **查看调试工具**: 访问 `/debug.html` 页面
2. **检查浏览器控制台**: 查看错误信息
3. **访问故障排除指南**: `GITHUB_PAGES_TROUBLESHOOTING.md`
4. **测试健康检查**: 访问后台健康检查地址

---

🎉 **恭喜！您的游戏时长监控面板已成功更新到 GitHub Pages，享受全新的数据库功能吧！**